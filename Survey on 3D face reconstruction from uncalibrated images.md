## 摘要
**人们投入了大量精力来开发从未校准的 2D 图像重建 3D 人脸的系统**。然而，**从 2D 到 3D 的人脸重建问题是病态的，因此需要先验知识来限制解决方案空间**。根据用于添加先验知识的技术对所提出的方法进行了分类，考虑了三种主要策略，即**统计模型拟合、光度学和深度学习，**并分别回顾了它们中的每一种。此外，考虑到统计 3D 面部模型作为先验知识的相关性，我们解释了构建过程并提供了一份最受欢迎的公开 3D 面部模型列表。在对 3D-from-2D 面部重建方法进行详尽研究后，我们观察到**深度学习策略自最近几年以来迅速发展，成为替代广泛统计模型拟合的标准选择**。与其他两种策略不同，与统计模型拟合和深度学习方法相比，**基于光度学的方法由于需要限制其重建质量的强大基础假设而在数量上有所减少**。
## 1. Introduction
3D 面部信息通常使用立体视觉系统、3D 激光扫描仪（例如 NextEngine 和 Cyberware）或 RGB-D 相机（例如 Kinect）来捕获。前两个捕获高质量的面部扫描，但需要受控环境和昂贵的机器。相比之下，RGB-D 相机更便宜且更易于使用，但生成的扫描质量有限。捕获面部 3D 扫描的一个有吸引力的替代方法是从未校准的 2D 图片 估计其几何形状。这种从 2D 到 3D 的重建替代方案旨在将捕获 2D 图像的简单性与面部几何形状的 3D 表示的优势结合起来。尽管这种方法很有吸引力，但它本质上是一种病态的。3D-from-2D 重建方法成功的关键是添加先验知识来解决解决方案中的歧义。在过去十年中，我们可以区分三种添加先验信息的策略，即**统计模型拟合、光度立体和深度学习**。在第一个模型中，先验知识被编码在一个 3D 面部模型中，该模型由一组 3D 面部扫描构建而成，并与输入图像相匹配。在第二种情况下，将 3D 模板人脸或 3D 人脸模型与光度立体方法相结合来估计人脸表面法线。这种策略下的方法通常使用来自多个图像的信息，这进一步限制了问题。在第三种情况下，2D-3D 映射是通过深度神经网络实现的，在给定适当的训练数据的情况下，可以学习关联面部几何形状和外观所需的先验知识。
本调查的其余部分组织如下：在第 2 节中，我们首先介绍构建统计 3D 面部模型的最流行方法，并列出最常用于 3D-from-2D 面部重建的公开可用模型。在第 3 节中，我们回顾了基于统计模型拟合的方法。在第 4 节和第 5 节中，我们分别回顾了基于光度学和深度学习的方法。第 6 节对使用其他机器学习方法的方法进行了分组，例如回归。最后，在第 7 节中，我们回顾了未校准图像 3D 人脸重建的主要应用，并在第 8 节中提供了结论。
## 2. Background: Statistical 3D facial models
正如介绍中所述，从 2D 到 3D 的人脸重建是一个病态问题，因此它需要某种先验知识来解决其他不确定的解决方案。
统计 3D 面部模型是添加此先验信息的最流行方式，因为它们对面部的几何变化进行编码，可能与外观相结合。这些模型由平均脸及其几何形状和外观的变化模式组成。将 3D 面部模型拟合到照片是通过估计（除了模型参数）3D 姿势和照明来完成的，这样投影到所得 3D 面部的图像平面中会产生与给定图片尽可能相似的图像。
### 2.1. Construction of a 3D facial model
最广泛的 3D 人脸统计模型是 3D 可变形模型 (3DMM)，由 Blanz 和 Vetter提出，用PCA主成分分析提取形状和纹理。3DMM 背后的想法是，如果 3D 人脸集足够大，则可以将任何新的纹理形状表示为训练 3D 人脸的形状和纹理的线性组合。
$\mathbf{x}_{\text {new }}=\sum_{m=1}^{M} a_{m} \mathbf{x}_{m}, \quad \mathbf{c}_{\text {new }}=\sum_{m=1}^{M} b_{m} \mathbf{c}_{m}$，x是形状，c是纹理。
当训练集 M 中的形状数量很大时，参数化会变得更加复杂。 PCA 有助于压缩数据，对正交坐标系执行基础变换，该正交坐标系由根据训练集中的形状和反照率计算的协方差矩阵的特征向量 φi 和 ψi 定义。在 PCA 给出的正交基中
$\begin{array}{l}
\mathbf{x}_{\mathrm{new}}=\overline{\mathbf{x}}+\sum_{i=1}^{M-1} \alpha_{i} \phi_{i}=\overline{\mathbf{x}}+\boldsymbol{\Phi} \boldsymbol{\alpha} \\
\mathbf{c}_{\mathrm{new}}=\overline{\mathbf{c}}+\sum_{i=1}^{M-1} \beta_{i} \psi_{i}=\overline{\mathbf{c}}+\boldsymbol{\mu} \boldsymbol{\beta}
\end{array}$
虽然大多数现有的 3D 统计面部模型都是基于上述过程，但这种方法有两个局限性，一些研究人员已经注意到了这一点。**首先**，PCA 估计对输入数据进行全局建模的基向量，因此无法捕获皱纹等细微信息，因此通过拟合 3DMM 重建面部细节成为一项艰巨的任务。**第二个缺点**，面部形状变化不是完全线性的，因此无法使用线性模型准确建模。
### 2.2. Available 3D facial models
3DMM
Basel Face Model (BFM)
Surrey Face Model (SFM)
LSFM
 H. Dai, N. Pears, W. Smith, C. Duncan, Statistical modeling of craniofacial shape and texture, Int. J. Comput. Vis. 128 (2) (2020) 547–571. 提出了构建 3DMM 的全自动管道，两者主要包括地标的自动检测、跨所有网格的共享三角测量的计算和模型构建。**使用最先进的地标检测器在每个网格的多个 2D 渲染中检测到 2D 地标**。**这些 2D 地标通过反转渲染映射到 3D 人脸**。然后，**通过使用 NICP 算法对预定义的模板网格进行变形以适合面部形状来建立密集对应关系**。从所有配件的初始 PCA 模型中，可以通过表现为异常值的相应形状向量来识别错误的对应关系。然后通过在**排除异常值后对训练集应用 PCA 获得最终模型**。通过这条管道，他们展示了迄今为止最大的 3DMM，即大型面部模型 (LSFM)，该模型由 9,663 个人构建而成，涵盖各个年龄段（图 2）、性别（48% 为男性）和种族（82% 为白人） , 9% 亚洲人, 5% 混血儿, 3% 黑人和 1% 其他种族)。该数据集的大小允许根据特定年龄范围和种族的形状构建更小的模型。
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1674914411597-25cdcb02-b33e-49ae-bea8-97803c8ced71.png)
与所有其他作品不同，A. Ranjan, T. Bolkart, S. Sanyal, M.J. Black, Generating 3D faces using convolutional mesh autoencoders, in: Proc. of ECCV, 2018, pp. 725–741. 使用深度学习建立非线性面部模型。他们训练了一个自动编码器架构，通过强制网络从估计的潜在表示中重建原始网格，从 3D 面部扫描中学习潜在空间。他们从 12 个人的 12 种面部表情中捕获了 3D 面部扫描，总共构成了一个包含 20,446 个网格的训练集。
## 3. Statistical model fitting methods
使用统计模型对 3D 面部结构的先验知识进行编码，可以通过找到最适合给定 2D 图像的模型基础的线性组合，从一张或多张照片重建新的 3D 面部。本质上，**将 3D 面部模型拟合到 2D 图像意味着优化非线性成本函数**，尽管也探索了其他方法，例如成本函数的线性化或概率公式。
从单张野外图片重建人的 3D 面部几何形状和外观比使用多张图像更具挑战性。这就是为什么大多数作品主要关注从**单个图像重建 3D 人脸**。尽管如此，一些研究人员还是考虑了**多幅图像，通过观察不同姿势和光照条件下的主体面部来提高重建精度**。同样，其他人提出**使用 2D 视频序列作为从同一个人获取一组图片的简单方法**。但是，在使用视频时，必须考虑帧之间的时间关系。
在本节中，我们总结并比较了过去十年中提出的将 3D 面部模型拟合到一个或多个 2D 图像的最相关方法。我们回顾了我们在 3DMM 拟合工作中确定的三种不同方法：成本函数的非线性优化（第 3.1 节）、线性方法（第 3.2 节）和概率方法（第 3.3 节）。最后，在第 3.4 节中，我们解释了一些研究人员如何提议通过将面部划分为子区域来以局部方式拟合 3DMM。表 1 和表 2 汇总了审查的工作，第 3.5 节总结了主要结论。
### 3.1. Optimisation of a non-linear cost function
Blanz 和 Vetter 的 3DMM
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1674915267094-ffb3dfc9-b356-46e4-92b5-e6e80da1600e.png)

#### 3.1.1. Redefining the image error
重新定义图像误差
#### 3.1.2. Multi-stage optimisation
多阶段优化通过在不同阶段最小化成本函数来重建 3D 面部形状

- 分阶段重建 3D 人脸，每个阶段逐步添加细节以完善前一个
- 训练级联回归器
- 拆分 3D面部重建过程分为对主体面部几何形状的估计和对外观的估计，包括光照
### 3.2. Linear approaches
前面提到的所有工作都利用非线性误差函数的优化，类似于 Blanz 和 Vetter 最初提出的方法。然而，O. Aldrian, W.A.P. Smith, A linear approach of 3D face shape and texture recovery using a 3D morphable model, in: Proc. of BMVC, 2010, pp. 75:1–75:10.观察到 Blanz 和 Vetter 提出的优化问题非常复杂，计算量大，并且由于其病态性质而容易陷入局部最小值。为了避免这种情况，他们提出了一种替代方案：以线性方式拟合 3DMM，分别用于投影参数、面部几何形状和纹理。Aldrian 和 Smith  提出了一种完全线性的方法，该方法后来被进一步探索.
虽然将拟合过程线性化会提高计算效率，但由此产生的重建不是很准确，并且需要强有力的假设。
L. Ding, X. Ding, C. Fang, 3D face sparse reconstruction based on local linear fitting, Vis. Comput. 30 (2) (2014) 189–200. 认为 Aldrian 和 Smith  提出的线性估计几何的方法有两个主要缺点：首先，在相机投影矩阵估计中，他们没有考虑正交性质旋转矩阵，其次，以两步的方式分别估计相机和形状参数，并不能保证在每一步中都减少成本函数。为了解决第一个缺点，Ding 等人 提出重新缩放和正交化由 Aldrian 和 Smith 算法产生的相机投影矩阵，以强制旋转矩阵的正交性。第二个缺点是通过联合估计相机投影矩阵和形状参数来解决的。
### 3.3. Probabilistic approach
S. Schönborn, A. Forster, B. Egger, T. Vetter, A monte carlo strategy to integrate detection and model-based face analysis, in: Proc. of GCPR, 2013, pp. 101–110.提出了一种非常不同的拟合 3DMM 的方法。他们将拟合 3DMM 的过程重新表述为概率推理问题。
### 3.4. Local approaches
大多数提出的重建人的 3D 面部的技术都以全局方式解决问题，将整个面部模型拟合到图像中。然而L. Ding, X. Ding, C. Fang, 3D face sparse reconstruction based on local linear fitting, Vis. Comput. 30 (2) (2014) 189–200.以及M. Piotraschke, V. Blanz, Automated 3D face reconstruction from multiple images using quality measures, in: Proc. of IEEE CVPR, 2016, pp. 3418–3427. 以局部方式解决了考虑面部子区域的拟合过程，尽管方式略有不同。
### 3.5. Take-home message
将 3DMM 拟合到 2D 图像基本上包括找到模型基的线性组合，这些模型基产生最类似于输入图片的人物图像的 3D 人脸。为此，社区使用了不同的输入方式并提出了不同的方法。虽然最广泛的输入是单个图像，这是最具挑战性的场景，但一些研究人员已经将 3DMM 安装到来自同一个人甚至视频序列的图像集合中，通过从不同的姿势和照明观察对象来提供更多信息.此外，大多数提议的作品使用一组相应的地标来驱动拟合过程，但也采用了其他特征，例如纹理边缘或复杂图像特征。
我们已经确定了三种将 3DMM 拟合到图像的主要方法：非线性成本函数的优化（最广泛使用的一种）、成本函数的线性化和概率公式。虽然这三种方法优化模型参数的方式不同，拟合过程由相同的主要元素指导：地标或相应的 2D-3D 点、渲染图像和统计正则化。 2D-3D 对应集通过在投影到图像平面时强加 3D 点的已知 2D 位置来指导拟合。渲染图像通过在渲染外观和输入图像之间施加一些相似性度量来做到这一点。最后，通过施加 3DMM 定义的统计正则化来确保合理的重建。
虽然非线性成本函数的优化允许轻松地合并许多不同（复杂）的项，但它可能会陷入局部最小值甚至发散，并且由于其计算成本，它可能比预期的要慢。相比之下，成本函数的线性化由于其更简单的性质而避免了大多数这些问题，但更难将复杂的项纳入优化问题，并且通常需要强大的非现实假设。最后，由于概率推理框架，概率方法有利于不确定性的建模，但是，从后验分布中抽取样本的过程可能非常缓慢。
另一方面，尽管已经提出了多种不同的方法，但所有这些方法都受到安装的 3DMM 中包含的信息种类的限制。例如，基于生成合成图像的方法不能用于拟合不对appearance建模的 3DMM，例如 FaceWarehouse。在这种情况下，社区利用了额外几何特征的信息，例如轮廓地标和遮挡边界。同样，如果拟合的 3DMM 不对表情进行建模，则该方法的准确性可能会降低，因为与表情相关的形状变化可能会被误解为与身份相关的变化。
## 4. Photometric methods
光度 3D-from-2D 人脸重建方法从一组图像中估计照明参数和表面法线，通常假设使用 Lambertian 反射模型。这种基于光度学重建表面 3D 几何形状的方法最初是由 R.J. Woodham, Photometric method for determining surface orientation from multiple images, Opt. Eng. 19 (1) (1980) 139–144. 提出的，他提出通过在不同光照条件下观察物体来估计多个 2D 图像的表面法线。
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1674999360951-0e215ef1-0d4d-4769-a069-d35380fd79c1.png)
### 4.1. Multiple image methods
### 4.2. Single image methods
在重建过程中必须包含额外的先验知识。我们已经确定了三种不同的方式来合并这些先验信息：第一种是使用预先设计的模板网格来拟合输入图像I. Kemelmacher-Shlizerman, R. Basri, 3D face reconstruction from a single image using a single reference face shape, IEEE Trans. Pattern Anal. Mach. Intell. 33 (2) (2011) 394–405.，第二种是通过训练一个集成了光照和形状信息的模型M. Lee, C.-H. Choi, Real-time facial shape recovery from a single image under general, unknown lighting by rank relaxation, Comput. Vis. Image Underst. 120 (2014) 59–69.，最后一个是通过拟合 3DMM 获得粗略的 3D 人脸估计，然后对其进行细化G. Rotger, F. Moreno-Noguer, F. Lumbreras, A. Agudo, Detailed 3D face reconstruction from a single RGB image, in: Proc. of WSCG, 2019, pp. 103–112.
### 4.3. Take-home message
基于光度学的 3D-from-2D 人脸重建方法试图从一个或多个 2D 图像恢复表面法线，通常，通过假设将 RGB 图像分解为反照率、光照和法线的 Lambertian 照明模型。然而，由于图像不受约束，光源是未知的，纯反照率也是如此。因此，必须将额外的先验知识添加到重建问题中以对其进行约束。
使用的先验知识类型清楚地将它们分为两组：一组通过在不同光照条件、姿势、表情等下从同一主题获取图像集合来限制重建，以及使用单个图像，但以 3DMM 或 3D 面部模板的形式添加 3D 约束。
本质上，使用图像集合的方法基于将矢量化图像形成的矩阵分解为两个矩阵，一个包含照明信息，另一个包含反照率和表面法线。尽管这些方法能够捕捉到精细的细节，但所需的图像量通常很大，并且重建结果相当嘈杂，因为它们缺乏几何先验来将解决方案约束为一个似是而非的人脸。
另一方面，单图像方法更加异构。例如，一些作品构建了一个照明形状模型，然后将其拟合到图像上，而其他作品则通过最小化输入图像与使用估计的朗伯模型获得的图像之间的差异来细化通过 3DMM 拟合获得的粗糙 3D 人脸精致的法线。最后一类基于 3DMM 的方法是最有前途的，因为通过结合 3DMM 中编码的全局面部形状的先验知识和基于光度测量的方法可以捕获的精细细节，他们能够重建非常详细的逼真 3D 面部，而不会忽视全局合理性.
## 5. Deep learning methods
第 3 节和第 4 节中的 3D-from-2D 人脸重建方法使用模型来体现先验知识：统计模型拟合方法包括几何（通常是纹理）模型，光度法对人脸的反射率进行建模。相比之下，深度学习方法直接学习 2D 图像和 3D 人脸之间的映射，将先验知识编码到训练网络的权重中。
尽管深度学习在许多不同的应用中已被证明是一个非常强大的工具，但由于缺乏真实的 3D 面部扫描，它在 3D-from2D 面部重建中的直接应用受到阻碍。然而，研究人员提出了不同的方法来生成和学习具有现实代表性的训练数据，从而规避了缺乏地面实况数据的障碍。
在本节中，我们介绍并比较了以深度学习为主要工具的 3D-from-2D 人脸重建中最相关的工作。在学习过程中涉及的众多元素中，我们考虑三个具有代表性的元素，即 (1) 用于训练网络的训练集，(2) 学习框架，以及 (3) 训练标准。我们根据这些项目组织本节。
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675062000460-d208f29c-2e1c-4a89-bb7b-573189c36faa.png)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675062174544-c90f758e-4f0a-4ebb-9f07-a5f5926f5567.png)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675062211136-231a3883-d9d8-41f2-834b-d8fd517f224f.png)
### 5.1. Training data set
我们可以区分构建综合训练集的三种主要策略。我们将第一个称为 Fit&Render，它包括将 3DMM 拟合到真实图像，然后使用估计的 3D 人脸渲染合成图像。第二个是 Generate&Render，通过从 3DMM 随机采样生成 3D 人脸，然后再次使用生成的 3D 人脸渲染合成图像。另一方面，最近几年出现了一种新策略，即自我监督训练，避免了对 2D-3D 配对数据的需要，从而避免了构建合成数据集的需要。基于这三种主要策略的建议方法分别在第 5.1.1-5.1.3 节中进行了回顾。然而，还有其他作品使用了由 Fit&Render 和 Generate&Render 构建的合成训练数据集，或者使用了真实数据。这些工作在第 5.1.4 节中进行了总结。
#### 5.1.1. Fit&Render strategy
Fit&Render 策略基于将 3DMM 拟合到真实图像。然后，为了扩大对应于 3D 人脸的 2D 图片集的可变性，使用估计的 3D 人脸创建合成图像。尽管此策略允许在训练集中拥有逼真的 2D 图像，这有助于网络在测试时表现更好，但它并非没有弱点。一个缺点是，经过训练的深度学习方法的准确性在很大程度上取决于用于重建地面真实 3D 人脸的 3DMMfitting 算法的准确性。换句话说，由于深度学习方法被教导重建估计的 3D 人脸，它将学习重现使用 3DMM 拟合算法获得的结果。此外，深度学习的优势之一，即它从训练数据中学习非线性的能力，受到训练它的线性建模 3D 数据的限制。一些作品试图克服这些障碍，例如，包括真实数据集、从多幅图像重建，或通过改进粗糙的 3D 面部重建。
Fit&Render 策略首先由 Zhu 等人提出 Face alignment across large poses: A 3D solution, in: Proc. of IEEE CVPR, 2016, pp. 146–155.。他们提出了一种面部轮廓分析技术，用于生成较大姿势的图像，创建 300W-LP（300 W 大姿势）数据库。他们首先通过在背景上拟合 3DMM 来估计给定面部图像上的 3D 网格。然后，将 3D 网格旋转并投影到图像上，生成与原始图像相似但姿势更大的合成图像。这个 300W-LP 数据库已被许多其他作者使用，因为它包含具有地面真实 3DMM 和投影参数的逼真且具有挑战性的面部图像。
#### 5.1.2. Generate&Render
Generate&Render 策略包括从 3DMM 中采样以获得真实的 3D 人脸，然后通过在不同条件（姿势、光照等）下渲染 3D 人脸来创建相应的 2D 图像。该策略避免使用辅助 3DMM 拟合算法，因此网络的学习能力不限于重建算法的学习能力。然而，与 Fit&Render 策略不同，2D 图像并不真实，因为渲染过程是完全合成的，具有合成背景、光照条件、投影参数等。此外，该策略没有克服从线性建模数据中学习的缺点，因为仍然使用 3DMM 来创建地面实况 3D 面孔。意识到这些缺点，遵循 Generate&Render 策略的工作提出了不同的方法来克服它们，例如包含真实数据、向 3D 人脸添加合成变形或采用更复杂的训练框架。
#### 5.1.3. Self-supervision
鉴于缺乏真正的 ground truth 3D-2D 配对数据以及使用合成集进行训练的缺点，一种新的策略自我监督正在引起人们的关注。主要思想是数据本身通过在网络末端添加渲染层来提供监督。该渲染层采用带纹理的 3D 人脸和主网络估计的渲染参数并渲染合成图像。这使得通过最小化输入图像和渲染图像之间的差异，无需地面真实 3D 人脸即可端到端地训练网络。一些作品使用合成修改后的图像训练他们的网络，以扩大光照、姿势等方面的可变性，而其他作品仅使用真实图像。
#### 5.1.4. Others
### 5.2. Learning framework
#### 5.2.1. Single network with single-pass training
卷积神经网络 (CNN) 在处理 2D 图像时显示出令人印象深刻的结果，鼓励研究人员使用 CNN 从未校准的 2D 图像重建 3D 人脸。
#### 5.2.2. Iterative training
与上一节中作品采用的单次训练相比，其他作者提出以迭代的方式训练他们的网络。我们可以区分两种不同的方法：一种是基于迭代改进合成训练集，另一种是基于迭代改进前一次迭代的结果。
G. Zhang, H. Han, S. Shan, X. Song, X. Chen, Face alignment across large pose via MT-CNN based 3D shape reconstruction, in: Proc. of IEEE FG, 2018, pp. 210–217.将他们的工作重点放在大姿势面部对齐上，即通过 3D 面部重建检测面部标志。
在他们的早期工作 X. Zhu, Z. Lei, X. Liu, H. Shi, S.Z. Li, Face alignment across large poses: A 3D solution, in: Proc. of IEEE CVPR, 2016, pp. 146–155. 中，他们向网络提供 2D 图像和表示当前估计的 3D 人脸的特征，即投影归一化坐标代码。该特征被计算为投影的 3D 人脸，其标准化坐标（到 [0, 1]）作为其颜色图，并允许它们 (1) 将前一次的估计传递给下一次迭代，(2) 反映拟合当前估计的准确性，以及（3）应用卷积运算。在他们的扩展工作 X. Zhu, X. Liu, Z. Lei, S.Z. Li, Face alignment in full pose range: A 3D total solution, IEEE Trans. Pattern Anal. Mach. Intell. 41 (1) (2019) 78–92. 中，他们提出了一个双流网络，其输出由一个全连接层组合。其中一个流是之前的流，另一个输入采样 3D 点的投影位置。这种架构允许他们分别处理两个不同的信息源，这些信息源相互补充，从而改进了之前的结果。
与上述所有工作不同，A. Jourabloo, X. Liu, Pose-invariant face alignment via CNN-based dense 3D model fitting, Int. J. Comput. Vis. 124 (2) (2017) 187–203.交替使用两个不同的回归器：一个估计 3DMM 参数更新，另一个估计投影参数的更新。他们使用了孪生网络，它有两个共享权重的分支来同时处理输入图像及其镜像图像。通过这种架构，他们可以强制更新 2D 地标（3D 地标的投影）以使输入图像和镜像图像相似，从而进一步限制面部对齐问题，从而实现更好的重建。
#### 5.2.3. Encoder-decoder
编码器-解码器架构将网络分为两部分：编码器，它从输入人脸图像中提取降维的代表性特征，以及解码器，它根据编码器估计的特征估计输入数据的重建。这种重建可以是一个 3D 人脸，其几何形状对应于输入图像中的人脸，可以恢复 3D 人脸的面部模型的参数，或者类似于输入图像的合成 2D 图像，等等。
PRNet的扩展-X. Zhu, F. Yang, D. Huang, C. Yu, H. Wang, J. Guo, Z. Lei, S.Z. Li, Beyond 3DMM space: Towards fine-grained 3D face reconstruction, in: Proc. of ECCV, 2020.
#### 5.2.4. Generative adversarial networks
生成对抗网络 (GAN) 允许通过联合训练两个独立的网络（生成器和鉴别器）相互竞争来学习真实 3D 人脸的分布。生成器 G : X → Y 将输入数据 x ∈ X 映射到（可能）不同的空间 y ∈ Y，G(x) = y。鉴别器估计数据点 y ∈ Y 是真实数据而不是由 G 综合生成的概率。在这个框架中，鉴别器被训练以正确区分真实数据和合成数据，而生成器被训练以欺骗鉴别器通过生成类似于真实数据的数据。这种方法已用于细化粗糙的 3D 人脸并获得更准确的 3D 人脸。
#### 5.2.5. Multiple networks for different tasks
在本节中，我们对使用多个网络的方法进行了分组，其中每个网络都针对不同的任务进行了训练。这些方法可以分为三个主要模块：(1) 多级系统，(2) 从粗到精的系统，以及 (3) 具有多个分支的网络。

- (1) 在多阶段系统中，训练多个网络以顺序方式估计不同的参数。
- (2) 由粗到细的系统通常由两个级联连接的网络组成，并经过训练分别估计粗略的 3D 人脸和精细级别的细节。
- (3) 最后，第三块由其体系结构具有多个并行网络的方法组成，这些并行网络处理输入图像以估计不同的属性。
#### 5.2.6. Geometric deep learning
表示 3D 面部表面的最常见方法是使用网格，即顶点位于 R3 中的无向图。然而，经典卷积无法处理非欧几里德域（例如网格、图形、流形等），这就是为什么许多研究人员使用符合欧几里得设置的替代表示。正如我们上面已经提到的，一些人使用了深度图或体积表示，而其他人则将 3D 人脸投影到 2D 空间，例如输入图像空间 或 UV 空间 .尽管如此，3DMM 提供的参数表示仍然是最广泛的，因为 3DMM 使用欧几里得子空间对形状变化进行建模，其中 3D 人脸由模型参数描述。
最近一个新兴的研究领域称为几何深度学习M.M. Bronstein, J. Bruna, Y. LeCun, A. Szlam, P. Vandergheynst, Geometric deep learning: Going beyond euclidean data, IEEE Signal Process. Mag. 34 (4) (2017) 18–42.，其重点是将深度学习方法推广到非欧几里德数据。特别是，Bruna 等人。J. Bruna, W. Zaremba, A. Szlam, Y. LeCun, Spectral networks and locally connected networks on graphs, in: Proc. of ICLR, 2014. 提出了一种使用光谱滤波器将经典卷积扩展到图形的技术。
GCN 的引入允许直接处理 3D 面部网格，不需要中间表示，从而保持其拓扑结构。此外，GCN 中的参数数量很少，这意味着计算复杂度降低。
鉴于从输入图像中提取的不确定性感知特征回归 3D 形状（参见第 5.2.3 节），Gao 等人。Z. Gao, J. Zhang, Y. Guo, C. Ma, G. Zhai, X. Yang, Semi-supervised 3D face representation learning from unconstrained photo collections, in: Proc. of IEEE CVPR Workshops, 2020, pp. 348–349. 提取身份和表情相关的特征，并使用两个 GNC 分别回归 3D 面部形状和逐顶点纹理。
### 5.3. Training criterion
学习的另一个决定性因素是训练标准，即网络在训练过程中最小化的损失函数（也称为成本或误差函数）。显然，这个损失函数直接取决于网络的输出，因为粗略地说，学习网络的权重是为了最小化估计输出和地面实况之间的误差。因此，我们将在第 5.3.1 节中的参数空间中计算的误差和在第 5.3.2 节中的 3D 空间中计算的误差分组。此外，如上所述，许多作品使用未标记的数据训练他们的网络，因此我们在第 5.3.3 节中回顾了用于进行自我监督训练的损失。在第 5.3.4 节中，我们展示了用于训练拟议的生成对抗网络的损失，在第 5.3.5 节中，我们展示了无法归类为上述任何一组的损失。
#### 5.3.1. Loss functions in the parameters space
大多数展示的作品都是根据输入图像估计 3DMM 的参数。其中，成本函数中包含的一个流行术语是估计参数和真实参数之间的误差，分别为 θ 和 θgt。
#### 5.3.2. Loss functions in 3D space
另一个已使用的损失函数是重建和地面真实 3D 人脸之间的欧几里得距离。
#### 5.3.3. Self-supervised training
最近，将渲染估计的 3D 纹理面部与输入图像生成的合成图像进行比较，使许多研究人员能够在不需要 2D-3D 数据对的情况下训练神经网络。
#### 5.3.4. Adversarial loss
#### 5.3.5. Other losses
### 5.4. Take-home message
深度学习已被证明是适用于许多不同领域的非常强大的工具，引起了研究界很大一部分的关注，从 2D 到 3D 的人脸重建也不例外。在过去几年中，大量工作提出使用深度学习从一张或多张图像甚至视频序列重建人的 3D 面部几何形状。
然而，深度学习有一个重要的缺点：需要大量的训练集，在这种情况下，训练集由相应的 2D 图像和 3D 人脸对组成。由于获得如此数量的真实 3D 面部扫描并不总是可行的，因此社区探索了两种策略来克服这一限制：构建合成训练集和自我监督。第一个侧重于通过将 3DMM 拟合到真实图像 X. Zhu, Z. Lei, X. Liu, H. Shi, S.Z. Li, Face alignment across large poses: A 3D solution, in: Proc. of IEEE CVPR, 2016, pp. 146–155. 或从 3DMM E. Richardson, M. Sela, R. Kimmel, 3D face reconstruction by learning from synthetic data, in: Proc. of 3DV, 2016, pp. 460–469. 采样获得的 3D 人脸渲染合成图像来构建合成数据。尽管这些方法允许构建大型异构训练集，但在 3DMM 学习到的分布之外重建 3D 人脸可能是一项艰巨的任务，因为除了 3DMM 生成的人脸之外，没有教给网络任何东西。
第二种基于自我监督的策略增长非常快，因为它避免了对 ground truth 3D 人脸的需求。这种自我监督的方法包括在网络末端添加一个渲染层，从重建的 3D 人脸渲染合成图像。因此，在训练阶段，输入图像和渲染图像之间的差异被最小化，以便网络学习生成 3D 人脸，从而生成与输入图像相同的合成图像。
虽然这种方法绕过了配对 2D-3D 数据的需要，但它有两个弱点。首先，必须准确恢复 3D 人脸的纹理，这本身就是一项艰巨的任务，而且在某些应用中，不一定会感兴趣。其次，必须使用额外的特征仔细调整训练过程，因为由于问题的不适定性质，仅最小化图像之间的差异并不能保证正确重建 3D 几何。事实上，许多作品都使用 3DMM 作为先验知识来限制通过自我监督训练获得的可能解决方案的空间，因此受到与上述使用合成训练数据的作品类似的限制。
此外，无论采用何种训练策略，真实 ground truth 3D 面部扫描的不足带来了另一个限制：精细细节的重建。这些细节负责使每个人都独一无二，因此对于恢复准确的 3D 人脸至关重要。然而，合成数据不像真正的 3D 面部扫描那样详细，因为它是用 3DMM 生成的，而自监督训练策略是从真实的 2D 图像中学习的，这些图像确实展示了面部细节，但不是 3D 的，从而使它们的几何重建非常困难。
因此，细节的重建成为社区面临的另一大挑战。一些作品探索了多视图的好处，以及对生成的面孔的迭代细化。此外，许多作品遵循“分而治之”的策略，提出由多个网络组成的架构，其中每个网络都估计一个属性（身份、表情、反照率、光照、姿势等）。这样，每个流都可以专注于单个任务，从而提高准确性。
然而，目前的结果表明，细微的细节必须与粗略的形状分开估计。一些作品使用已经提出的基于阴影形状的方法来估计细节，例如 [12,180]，而其他作品则按顺序集成了多个网络，其中每个网络都改进了前一个网络的输出。此外，最近，有研究人员使用生成对抗网络来迫使生成器生成更准确的 3D 面部重建。
即便如此，最有前途的研究方向还是偏离了 3DMM，要么通过估计非线性面部模型，要么通过采用几何深度学习方法。一方面，非线性模型的估计已被广泛探索，主要是通过使用编码器-解码器架构。在这种方法下，网络学习从输入图像中回归与 3D 人脸的不同元素（形状、表情、反照率、姿态等）相关的参数，然后从这些参数中恢复 3D 人脸。鉴于神经网络捕捉非线性的能力，使用这种方法可以对面部细节进行建模，并因此在生成的 3D 面部上进行重建。
另一方面，几何深度学习研究深度学习中常见的数学运算（如池化或卷积）对 3D 面部网格等非欧几里德数据的适应性，从而允许设计解决 3D 面部网格直接重建的网络，而无需需要替代的，而且通常是限制性的 3D 面部表示。
## 6. Other machine learning methods
尽管深度学习已成为 3D-from-2D 人脸重建中广泛使用的工具，但也探索了其他机器学习方法。他们中的大多数人将 3D-from-2D 人脸重建作为一个回归问题来处理，要么通过学习单个回归器，要么通过级联回归器。
## 7. Applications
从未校准的图像重建人的 3D 面部的可能性为许多应用程序提供了一种工具，可以从面部数据估计 3D 信息，避免需要专门的机器或受控环境，这并不总是可行的。在本节中，我们通过简要回顾其中一些应用来展示 3Dfrom-2D 人脸重建的影响。

- **Facial recognition.**人脸识别系统的目标是从图像中“识别”一个人，即将图片中的人脸与人脸数据库进行匹配。传统上，这项技术是使用二维图像开发的，因为它们的采集很简单。然而，同一个人的面部外观在不同图像中可能存在很大差异，这取决于拍照姿势、场景照明和人的表情等因素，使得识别任务具有挑战性。相比之下，3D 面部几何形状对于姿势和光照条件是不变的，因此它可以增加识别的鲁棒性。因此，鉴于获取 3D 面部数据并不总是可行，社区探索了基于 3D 面部重建的面部识别方法，通过拟合 3DMM [78,214-217]，使用深度学习方法 [112-114， 218]，或训练级联回归器 [211]，等等。
- **Face alignment.**人脸对齐旨在定位二维图像中的面部标志点。该领域在不需要 3D 面部表示的情况下得到了广泛研究，在正面图像中获得了令人满意的结果。然而，当姿势偏离正面视图时，由于自遮挡，并非所有地标都是可见的。通过将轮廓地标的语义含义更改为轮廓地标 [99]，在某种程度上，对于适度的姿势变化，已经克服了这个障碍，其中非轮廓地标仍然可见。然而，对于较大的平面外旋转，其中一半的脸被遮挡，这种 2D 方法会失败。因此，许多研究人员已经将面部对齐与 3D 到 2D 面部重建结合起来 [99,101103,110,119,122,142,154,209]。通过从 2D 图像重建 3D 面部几何形状，可以轻松估计平面外旋转；因此，可以通过将 3D 人脸中的界标投影到图像平面来确定 2D 图像中人脸界标的位置。![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675083125035-a3fadff6-9b2c-4356-9e15-58b35e67ba4a.png)
- **Face animation.**从图片中重建 3D 面部几何形状和纹理还可以构建个性化的化身，可用于游戏、电影和虚拟现实等领域。有些作品专注于获得高保真纹理 [219]，而其他作品则专注于重建细微的面部细节 [58,220]，或重建完整的 3D 头部，包括头发 [221,222]。图 5 显示了使用 3D-from-2D 人脸重建方法获得的 3D 动画的一些示例。![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675083220595-ef5b5622-02a9-4510-b358-c925892f94df.png)
- **Image editing.**估计参与图像形成过程的所有组件，例如 3D 面部几何，反照率、照明、姿势等允许通过编辑其中的一个或多个来生成新的合成图像。例如，面部正面化是通过将姿势修改为正面视图，从估计的纹理 3D 面部生成合成正面图像的任务 [63,223–225]。图像编辑的其他示例是对表达式 [226-228] 的操纵和对照明条件 [228] 的操纵。这些图像编辑方法被广泛用作数据增强技术，但也用作其他应用程序（如人脸识别）中的预处理程序。![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675083257127-6d7a5b21-0da6-4125-a035-4adbce56cd32.png)
- **Facial reenactment.**面部重演或面部运动重新定位包括捕捉一个人（源）的面部外观并将一些估计的特征（表情、姿势等）转移到另一个人（目标）。以这种方式，目标主体的图像被修改，使得他/她展示源图像中主体的选定特征。转移表情（面部动作）允许修改对象的视频序列，例如，使其与配音 [67,68,229]。它还可用于为艺术家设计的 3D 角色制作动画 [140,141]，或将目标对象的面部替换为源对象的面部 [230]。![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675083356593-f8254c41-5773-405d-8a38-5fde6f29b6f7.png)

尽管上面介绍的应用是探索最多的应用，但从 2D 图像重建 3D 人脸也已用于其他应用，例如反欺骗 [231,232]、年龄估计 [135] 或具有医学诊断目的的颅面分析 [ 23,24,233]。
## 8. Summary and conclusions
在本文中，我们回顾了过去十年中 3D-from-2D 人脸重建的最新技术，将提出的不同方法分为三种主要策略：3D 面部模型拟合（第 3 节）、光度立体（第 3 节） 4) 和深度学习（第 5 节）。图 8 通过显示每种策略的累计发表论文数来说明该领域的演变。
![image.png](https://cdn.nlark.com/yuque/0/2023/png/34409005/1675083426851-de4a893c-d93e-4d20-9dfb-4886fccf9d59.png)
从未校准的 2D 图片中恢复 3D 人脸是一个欠定问题，也就是说，如果没有先验已知的附加信息（例如相机位置或照明条件），无限数量的 3D 人脸可以生成相同的 2D 图像。因此，需要进一步的约束来明确地重建 3D 面部几何形状（在某些情况下，纹理），或者通过做出合理的假设，或者通过在重建过程中包含先验知识。
传统上，用于捕捉 3D 面部几何形状的非侵入性技术之一是光度立体，在完全受控的环境下，通过观察不同的光照条件如何影响物体的外观来估计表面法线。鉴于这些控制环境并不总是可行的，社区已经在光度立体领域内开发了一个新的分支来从未校准的图像重建 3D 人脸，即从在不受控制的条件下获得的图像，也就是在野外。然而，在这种情况下，重建问题再次不适定，因此必须添加额外的约束。一种广泛探索的方法是使用多幅图像，这使研究人员能够获得许多照明条件样本。这些方法能够重建非常详细的 3D 人脸，尽管他们考虑的假设（例如朗伯反射率）通常过于严格，并且估计的 3D 人脸可能会显示伪影，因为没有包含有关几何的先验知识。因此，其他工作提出通过拟合预先设计的 3D 面部模板来限制解决方案，但它们高度依赖于所选模板的特征（年龄、性别、种族等），这可能导致次优重建。结果，如图 8 所示，在过去十年中几乎没有探索光度立体策略。然而，最近的工作已经利用统计模型提供的先验知识来获得粗略的重建，然后再细化使用光度法，获得令人印象深刻的结果。
事实上，统计模型的使用在过去十年中得到了广泛探索（见图 8），因为它们通过对可能解决方案的空间建模来帮助获得合理的 3D 人脸，从而避免人工制品或不切实际的 3D 人脸重建。 3DMM 是最广泛使用的统计面部模型，因为它们能够对人脸的几何（可能还有纹理）变化进行编码。将 3DMM 拟合到图像包括在一组相应的 2D-3D 点的帮助下，通过最小化图像与 3DMM 在图像平面上的投影之间的差异来估计模型参数。大多数出版物都将拟合视为非线性成本函数的最小化，这使他们能够轻松地根据需要轻松合并尽可能多的项，以进一步推动重建过程。然而，这种优化很容易陷入局部最小值，并且通常具有显着的计算成本。这些缺点已经被研究人员发现，他们提出了线性方法来避免它们，尽管这通常需要进一步的假设，但并不总是现实的。此外，已经发现估计 3DMM 的参数不足以恢复精细的面部细节，因为这些模型通常编码全局面部变形。因此，大多数 3DMM 拟合方法只能重建粗略的形状，它们无法恢复对于实现忠实重建仍然很重要的细微几何细节。
在过去的几年中，最近出现了一种探索深度学习算法的趋势，该算法正在迅速发展，如图 8 所示。这些方法特别适合学习非线性，因此能够恢复细微的变化每个人的细节，同时保持逼真的 3D 面部。尽管如此，深度学习方法的主要缺点是训练它们需要大量数据。在 3D-from-2D 人脸重建的情况下，训练数据集应包含成对的 2D 面部图像和相应的 3D 面部几何形状（可选地带有纹理），但获得足够大的此类对集合具有挑战性。出于这个原因，为此目的探索神经网络的早期工作通过将 3DMM 拟合到真实图像和/或从随机采样的面部渲染合成图像（即一种数据增强）来构建合成训练集。尽管这允许研究人员训练复杂的神经网络，但它有两个主要缺点。首先，使用 3DMM 的重建作为地面实况将网络的重建能力限制为 3DMM 拟合方法的能力。其次，在处理真实图像时，使用合成图像训练网络可能会降低其效率。
因此，最近的作品重新考虑了拥有 3D ground truth 的必要性，并以自我监督的方式解决了训练过程。为此，他们在网络末端添加了一个渲染层，根据估计的纹理 3D 面部和渲染参数生成合成图像。该技术通过最小化输入真实图像与网络渲染图像之间的差异，避免了对大量成对 2D-3D 数据的需要。然而，为了能够从估计的 3D 人脸渲染合成图像，必须准确地恢复纹理，这本身就是一项具有挑战性的任务。此外，必须对学习进行适当的正则化以限制解决方案的空间，因为仅图像误差不足以确保解决方案的唯一性。
另一方面，真实数据的缺乏也限制了精细细节的学习，这是目前社区主要关注的问题，因为 3DMM 生成的合成数据不如真实数据那么详细，并且从输入图像中学习它们极具挑战性。经验发现表明，当在与 3D 人脸的全局估计不同的任务中估计精细细节时，可以获得最佳的精细细节重建。因此，许多研究人员采用了一种由粗到精的方法，这使他们能够恢复准确详细的 3D 人脸，证明该策略是一个有前途的研究方向。
此外，社区最近才开始探索另外两种方法：GAN 和 GCN。 GAN 已从许多不同的角度进行了探索，因为它们允许训练 3D 人脸重建网络以生成更逼真的 3D 人脸；然而，鉴于缺乏真正的 2D-3D 配对数据，如何采用这种架构仍然是一个悬而未决的问题。另一方面，一些研究人员发现了所有现有作品的一个共同缺点：3D 人脸通常由三角形网格表示，这是一种非欧几里得数据类型，但经典的深度学习操作只能处理欧几里得数据。几何深度学习是最近的一个研究方向，探索将经典深度学习操作扩展到非欧几里得数据（例如三角形网格）的技术，这促使出现了一种有前途的新方法，可以直接从输入图像重建 3D 面部网格。
尽管已经提出了各种不同的策略，但对大多数策略来说通用的工具是 3DMM，因为它可以将人脸的高度复杂变化捕获到降维的线性子空间中。然而，在重建过程中使用 3DMM 有两个缺点。首先，3DMM 的质量在很大程度上取决于训练集中包含的形状变化类型，因为不同年龄、性别、种族甚至表情的对象之间的面部形状可能非常不同。其次，3DMM 全局模拟面部变形，这限制了它们重建精细细节的能力。这种限制也被深度学习方法所继承，这些方法使用 3DMM 生成合成训练数据或限制其内部（潜在）表示。
因此，3D 人脸模型和 3D-from-2D 人脸重建是两个密切相关的研究领域，已经合作开发。 3D 面部模型可以确保从 2D 图像重建的 3D 面部的合理性，从而推动了该领域的发展。另一方面，3D 人脸重建方法受到面部模型提供的表示的限制，使精细细节的重建成为一个悬而未决的问题。因此，通过局部或非线性模型提高建模能力可能有助于获得更准确的详细 3D 重建。
